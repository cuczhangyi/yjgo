<!DOCTYPE html>
<html lang="zh">
<head>
    {{template "header" (ossUrl)}}
</head>
<body class="gray-bg">
<div class="container-div">
    <div class="row">

        <div class="btn-group-sm" id="toolbar" role="group">
            {{getPermiButton .Session.uid "module:rmp_type:edit" "addMetadata()" "新增" "btn btn-success" "fa fa-plus"}}
            {{getPermiButton .Session.uid "module:rmp_type:edit" "addMetadata()" "保存" "btn btn-success" "fa fa-plus"}}
        </div>

        <div class="col-sm-12 select-table table-striped">
            <p class="select-title">{{.name}}</p>
            <table id="bootstrap-table"></table>
        </div>
    </div>
</div>
{{template "footer" .Cookie.OssUrl}}
<link href="/resource//ajax/libs/bootstrap-table/extensions/editable/bootstrap-editable.css" rel="stylesheet"/>
<script src="/resource/ajax/libs/bootstrap-table/extensions/editable/bootstrap-editable.min.js"></script>
<script src="/resource/ajax/libs/bootstrap-table/extensions/editable/bootstrap-table-editable.js"></script>
<th:block th:include="include :: bootstrap-table-editable-js" />

<script type="text/javascript">
    var editFlag = '{{hasPermi .Session.uid "module:rmp_type:edit"}}';
    var datas ={{.metadata}};
    var dataObj = datas;
    var prefix = ctx + "module/rmp_type";
    var typeid = {{.type_id}}
    $(function () {
        var options = {
            url: prefix + "/getlistmetadata?id="+{{.type_id}},
            createUrl: prefix + "/addmetadata",
            modalName: "附属信息",
            columns: [
                {
                    field: 'name',
                    title: '名称',
                },
                {
                    field: 'code',
                    title: '代码(不可随便更改)',
                },
                {
                    field: 'values',
                    title: '备选值'
                },
                {
                    title: '操作',
                    align: 'center',
                    formatter: function (value, row, index) {
                        var actions = [];
                        actions.push('<a class="btn btn-danger btn-xs ' + editFlag + '" href="javascript:void(0)" onclick="editMetadata(\'' + row.code + '\')"><i class="fa fa-remove"></i>移除</a> ');
                        actions.push('<a class="btn btn-danger btn-xs ' + editFlag + '" href="javascript:void(0)" onclick="delMetaData(\'' + row.code + '\')"><i class="fa fa-remove"></i>编辑</a> ');
                        return actions.join('');
                    }
                }],
            onLoadSuccess: function (data) {
                dataObj = data.rows;
            },
            onLoadError:function (r) {
                dataObj = false;
            }
        };
        $.table.init(options);
    });

    function insertRow(){
        var randomId = 100 + ~~(Math.random() * 100)
        $("#" + table.options.id).bootstrapTable('insertRow', {
            index: 0, // 你想插入到哪，0表示第一行
            row: {
                userId: randomId,
                userCode: 2000000 + randomId,
                userName: '测试' + randomId,
                userPhone: '1588888888',
                userEmail: 'ry1@qq.com',
                userBalance: 10 + randomId,
            }
        })
    }

    /* 删除指定表格行 */
    function removeRow(){
        var ids = $.table.selectColumns("userId");
        if (ids.length == 0) {
            $.modal.alertWarning("请至少选择一条记录");
            return;
        }
        $("#" + table.options.id).bootstrapTable('remove', {
            field: 'userId',
            values: ids
        })
    }

    function updateRowByUniqueId(){
        var randomId = 100 + ~~(Math.random() * 100)
        $("#" + table.options.id).bootstrapTable('updateByUniqueId', {
            id: 1,
            row: {
                userId: randomId,
                userCode: 3000000 + randomId,
                userName: '测试' + randomId,
                userPhone: '1599999999',
                userEmail: 'ry2@qq.com',
                userBalance: 50 + randomId,
            }
        })
    }

    /* 查询行ID值为1的数据 */
    function getRowByUniqueId(){
        var data = $("#" + table.options.id).bootstrapTable('getRowByUniqueId', 1);
        alert(JSON.stringify(data))
    }

    function onClickRow(row, $element){
        alert("单击行userId：" + row.userId + " userName：" + row.userName);
    }


</script>
</body>
</html>